(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pagesB/profile/profile"],{"08e8":function(t,e,n){},"09f7":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return a}));var a={attachmentSelect:function(){return Promise.all([n.e("common/vendor"),n.e("components/attachment-select/attachment-select")]).then(n.bind(null,"eccf"))}},o=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.attachmentsSelectShow=!1})},c=[]},"20d3":function(t,e,n){"use strict";(function(t,e){var a=n("4ea4");n("1ea4");a(n("66fd"));var o=a(n("2722"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},2722:function(t,e,n){"use strict";n.r(e);var a=n("09f7"),o=n("3cc1");for(var c in o)["default"].indexOf(c)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(c);n("a9cd");var i=n("f0c5"),u=Object(i["a"])(o["default"],a["b"],a["c"],!1,null,"c2d6d530",null,!1,a["a"],void 0);e["default"]=u.exports},"3cc1":function(t,e,n){"use strict";n.r(e);var a=n("8710"),o=n.n(a);for(var c in a)["default"].indexOf(c)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(c);e["default"]=o.a},8710:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n("2393"),o={components:{tmSkeleton:function(){n.e("tm-vuetify/components/tm-skeleton/tm-skeleton").then(function(){return resolve(n("3f1b"))}.bind(null,n)).catch(n.oe)},tmButton:function(){n.e("tm-vuetify/components/tm-button/tm-button").then(function(){return resolve(n("9bbf"))}.bind(null,n)).catch(n.oe)},tmEmpty:function(){n.e("tm-vuetify/components/tm-empty/tm-empty").then(function(){return resolve(n("947c"))}.bind(null,n)).catch(n.oe)},tmForm:function(){Promise.all([n.e("common/vendor"),n.e("tm-vuetify/components/tm-form/tm-form")]).then(function(){return resolve(n("77a7"))}.bind(null,n)).catch(n.oe)},tmInput:function(){n.e("tm-vuetify/components/tm-input/tm-input").then(function(){return resolve(n("7908"))}.bind(null,n)).catch(n.oe)},tmImages:function(){Promise.all([n.e("common/vendor"),n.e("tm-vuetify/components/tm-images/tm-images")]).then(function(){return resolve(n("15db"))}.bind(null,n)).catch(n.oe)},tmActionSheetMenu:function(){n.e("tm-vuetify/components/tm-actionSheetMenu/tm-actionSheetMenu").then(function(){return resolve(n("d6a0"))}.bind(null,n)).catch(n.oe)},tmSheet:function(){n.e("tm-vuetify/components/tm-sheet/tm-sheet").then(function(){return resolve(n("d12c"))}.bind(null,n)).catch(n.oe)},AttachmentSelect:function(){Promise.all([n.e("common/vendor"),n.e("components/attachment-select/attachment-select")]).then(function(){return resolve(n("eccf"))}.bind(null,n)).catch(n.oe)}},data:function(){return{loading:"loading",queryParams:{size:10,page:0},result:{username:void 0,nickname:void 0,email:void 0,avatar:void 0,showAvatar:void 0,description:void 0},uploadAvatarShow:!1,attachmentsSelectShow:!1,verifyEmail:function(){return function(e){return{check:t.$tm.u.email(e),text:"请输入正确的邮箱"}}}}},onLoad:function(){this.fnSetPageTitle("个人资料")},created:function(){this.fnGetData()},onPullDownRefresh:function(){this.fnGetData()},methods:{fnGetData:function(){var e=this;this.loading="loading",t.showLoading({mask:!0,title:"加载中..."}),this.$httpApi.admin.getAdminProfile().then((function(t){if(200==t.status){var n=t.data.avatar;e.result=t.data,e.result.showAvatar=e.$utils.checkAvatarUrl(n),e.loading="success"}else e.loading="error"})).catch((function(t){console.error(t),e.loading="error"})).finally((function(){t.hideLoading(),t.stopPullDownRefresh()}))},fnShowUploadAvatarSelect:function(){this.uploadAvatarShow=!0},fnOnUploadAvatarChange:function(e){var n=this;switch(e.index){case 0:t.chooseImage({count:1,success:function(e){t.uploadFile({filePath:e.tempFilePaths[0],header:{"admin-authorization":(0,a.getAdminAccessToken)()},url:n.$baseApiUrl+"/api/admin/attachments/upload",name:"file",success:function(e){var a=JSON.parse(e.data);200==a.status?(n.result.avatar=a.data.path,n.result.showAvatar=n.$utils.checkAvatarUrl(a.data.path),n.$focusUpdate()):t.$tm.toast(a.message)},fail:function(e){t.$tm.toast(e.message)}})}});break;case 1:this.attachmentsSelectShow=!0;break}},fnOnAttachmentsSelect:function(t){this.result.avatar=t.path,this.result.showAvatar=this.$utils.checkAvatarUrl(t.path),this.attachmentsSelectShow=!1},fnSubmit:function(e){var n=this;if(!1===e)return t.$tm.toast("请填写必填项。");t.showLoading({title:"保存中..."}),this.$httpApi.admin.updateAdminProfile(this.result).then((function(e){200==e.status?(t.$tm.toast("保存成功"),n.$tm.vx.commit("blogger/setBlogger",n.result)):t.$tm.toast("保存失败，请重试！")})).catch((function(e){t.$tm.toast("保存失败，请重试！")}))}}};e.default=o}).call(this,n("543d")["default"])},a9cd:function(t,e,n){"use strict";var a=n("08e8"),o=n.n(a);o.a}},[["20d3","common/runtime","common/vendor"]]]);