(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tabbar/gallery/gallery"],{"32b2":function(t,e,n){"use strict";(function(t){var a=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n("448a")),i={components:{tmSkeleton:function(){n.e("tm-vuetify/components/tm-skeleton/tm-skeleton").then(function(){return resolve(n("3f1b"))}.bind(null,n)).catch(n.oe)},tmTranslate:function(){n.e("tm-vuetify/components/tm-translate/tm-translate").then(function(){return resolve(n("c684"))}.bind(null,n)).catch(n.oe)},tmFlotbutton:function(){Promise.all([n.e("common/vendor"),n.e("tm-vuetify/components/tm-flotbutton/tm-flotbutton")]).then(function(){return resolve(n("1902"))}.bind(null,n)).catch(n.oe)},tmTags:function(){n.e("tm-vuetify/components/tm-tags/tm-tags").then(function(){return resolve(n("0783"))}.bind(null,n)).catch(n.oe)},tmEmpty:function(){n.e("tm-vuetify/components/tm-empty/tm-empty").then(function(){return resolve(n("947c"))}.bind(null,n)).catch(n.oe)},tmIcons:function(){n.e("tm-vuetify/components/tm-icons/tm-icons").then(function(){return resolve(n("86fa"))}.bind(null,n)).catch(n.oe)},tmImages:function(){Promise.all([n.e("common/vendor"),n.e("tm-vuetify/components/tm-images/tm-images")]).then(function(){return resolve(n("15db"))}.bind(null,n)).catch(n.oe)},tmFlowLayout:function(){Promise.all([n.e("common/vendor"),n.e("tm-vuetify/components/tm-flowLayout/tm-flowLayout")]).then(function(){return resolve(n("1967"))}.bind(null,n)).catch(n.oe)},tmTabs:function(){Promise.all([n.e("common/vendor"),n.e("tm-vuetify/components/tm-tabs/tm-tabs")]).then(function(){return resolve(n("61fe"))}.bind(null,n)).catch(n.oe)}},data:function(){return{isBlackTheme:!1,loading:"loading",category:{activeIndex:0,activeValue:"",list:[]},queryParams:{size:10,page:0,team:null,keyword:""},cache:{dataList:[],total:0},isLoadMore:!1,loadMoreText:"",result:{},dataList:[]}},filters:{filterTakeTime:function(e){return t.$tm.dayjs(e).format("DD/MM/YYYY")}},watch:{globalAppSettings:{deep:!0,handler:function(){}}},onLoad:function(){this.fnSetPageTitle("个人图库"),this.fnGetCategory()},created:function(){this.fnGetData()},onPullDownRefresh:function(){this.isLoadMore=!1,this.queryParams.page=0,this.fnGetData()},onReachBottom:function(e){this.result.hasNext?(this.queryParams.page+=1,this.isLoadMore=!0,this.fnGetData()):t.showToast({icon:"none",title:"没有更多数据了"})},methods:{fnOnCategoryChange:function(t){this.dataList=[],this.queryParams.team=0==t?null:this.category.list[t],this.queryParams.page=0,this.fnToTopPage(),this.fnGetData()},fnGetCategory:function(){var t=this;this.$httpApi.getPhotoTeams().then((function(e){t.category.list=["全部"].concat((0,o.default)(e.data))}))},fnGetData:function(){var e=this;t.showLoading({mask:!0,title:"加载中..."}),this.isLoadMore||(this.loading="loading"),this.loadMoreText="",this.$httpApi.getPhotoListByPage(this.queryParams).then((function(t){if(200==t.status){if(e.loading="success",e.result=t.data,0!=t.data.content.length){var n=t.data.content.map((function(t,n){return t["image"]=e.$utils.checkImageUrl(t.thumbnail),t["model"]="text",t["takeTime"]=e.$tm.dayjs(t["takeTime"]).format("DD/MM/YYYY"),t}));e.fnCacheDataList(n),e.globalAppSettings.gallery.useWaterfull?(e.dataList=n,e.$nextTick((function(){e.$refs.wafll.pushData(n)}))):e.dataList=e.dataList.concat(n)}e.loadMoreText=t.data.hasNext?"上拉加载更多":"呜呜，没有更多数据啦~"}else e.loading="error",e.waterfall.loading="finish",e.loadMoreText=""})).catch((function(t){console.error(t),e.loading="error",e.waterfall.loading="finish",e.loadMoreText="加载失败，请下拉刷新！"})).finally((function(){setTimeout((function(){t.hideLoading(),t.stopPullDownRefresh()}),500)}))},fnCacheDataList:function(t){0==this.queryParams.page?this.cache.dataList=t:this.cache.dataList=[].concat((0,o.default)(this.cache.dataList),(0,o.default)(t))},fnOnClick:function(t){console.log("点击数据",t)},fnPreview:function(e){var n=this.cache.dataList.findIndex((function(t){return t.id==e.id}));t.previewImage({current:n,urls:this.cache.dataList.map((function(t){return t.image})),indicator:"number",loop:!0})}}};e.default=i}).call(this,n("543d")["default"])},"425c":function(t,e,n){"use strict";n.r(e);var a=n("d0d0"),o=n("858c");for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);n("a54e");var s=n("f0c5"),c=Object(s["a"])(o["default"],a["b"],a["c"],!1,null,"71075a28",null,!1,a["a"],void 0);e["default"]=c.exports},"48d0":function(t,e,n){"use strict";(function(t,e){var a=n("4ea4");n("1ea4");a(n("66fd"));var o=a(n("425c"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},"858c":function(t,e,n){"use strict";n.r(e);var a=n("32b2"),o=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=o.a},a54e:function(t,e,n){"use strict";var a=n("bde8"),o=n.n(a);o.a},bde8:function(t,e,n){},d0d0:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){}));var a=function(){var t=this.$createElement,e=(this._self._c,this.category.list.length),n="success"==this.loading?this.dataList.length:null;this.$mp.data=Object.assign({},{$root:{g0:e,g1:n}})},o=[]}},[["48d0","common/runtime","common/vendor"]]]);